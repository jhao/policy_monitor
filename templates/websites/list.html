{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2>关注网站列表</h2>
  <a href="{{ url_for('create_website') }}" class="btn btn-primary">新增网站</a>
</div>
<table class="table table-striped">
  <thead>
    <tr>
      <th>名称</th>
      <th>URL</th>
      <th>抓取子页面</th>
      <th>时间间隔(分钟)</th>
      <th>最后抓取时间</th>
      <th>操作</th>
    </tr>
  </thead>
  <tbody>
    {% for website in websites %}
    <tr>
      <td>{{ website.name }}</td>
      <td><a href="{{ website.url }}" target="_blank">{{ website.url }}</a></td>
      <td>{{ '是' if website.fetch_subpages else '否' }}</td>
      <td>{{ website.interval_minutes }}</td>
      <td>{{ website.last_fetched_at or '尚未抓取' }}</td>
      <td class="d-flex flex-wrap gap-2">
        <a href="{{ url_for('edit_website', website_id=website.id) }}" class="btn btn-sm btn-secondary">编辑</a>
        {% if website.last_snapshot %}
        <a href="{{ url_for('view_website_snapshot', website_id=website.id) }}" class="btn btn-sm btn-outline-primary">查看快照</a>
        {% endif %}
        <form action="{{ url_for('delete_website', website_id=website.id) }}" method="post" class="d-inline" onsubmit="return confirm('确认删除该网站？');">
          <button class="btn btn-sm btn-danger">删除</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
